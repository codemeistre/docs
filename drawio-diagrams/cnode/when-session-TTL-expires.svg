<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="972px" height="598px" viewBox="-0.5 -0.5 972 598" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2023-04-06T03:02:29.311Z&quot; agent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36&quot; etag=&quot;wPguTxrKe2F3Ns66qzcH&quot; version=&quot;21.1.4&quot; type=&quot;google&quot; pages=&quot;3&quot;&gt;&lt;diagram name=&quot;redis-arrangement&quot; id=&quot;b47Vy8jbhvGGFrSf2t7A&quot;&gt;7VpZc9s2EP41mkkepOGhy48W7TjtxEdrT/uYAUlIRAwRCgld/vVdECAFkiAl1ZKaTGOPx+ACXO7x7fIDpI7rzTd3CVpE9yzEtONY4abj3nQcxx7bDvwTkq2UjMaWFMwSEqpFO8EzecNKmC9bkhCnpYWcMcrJoiwMWBzjgJdkKEnYurxsymj5qQs0wzXBc4BoXfo3CXkkpeOBtZN/xmQW5U+2LTUzR/liJUgjFLK1JnJvO66XMMblaL7xMBXBy+Mi7/vUMFsYluCYH3JDYnfD2+UXb2utH5/ut+Or/pXVVVpWiC6Vw3/ikKTCXM4SERtpO9/mAUnYMg6x0Gl13Mk6Ihw/L1AgZtcAAZBFfE7hyoYhRT6mTywlnLAYZAHYihOYWOGEE4jyl8oCzoQGRMnMuPxaTfiMczaHiSmh1GOUwaKbmMVgxWTOVsjPrBUWJDglb/o144hr14BXrF+D9/olZcFr4azCmDY9ZTFXmHXEinpO8gCDA3ijiVSO7jCbY55sYYmadfoKL6pg7KG6Xu/g5+RFFOnQyxciBflZoXuHChgoYBwBkn4NJB1nSOGxEx8GMzEIfSuXwSMKcQ09ImB5vjqOa1nDoecZEixx0ISSIv2N+KohSAMlW3JKYuwVHcOqAAkM87IfkKc8Ya9YmxmOx/bEhZlZgkKCd+4o+OXiG5KAdmlWzBKROqUs7yOOkERoIUIz38xE/+zFmK9Z8pr28vI7DabGZUw51qCGqaEBUqNzIWqwH1G5QCCmhKHh9yXLJ7ppVnzXsABCtJG3qflc0QPj4gVyreFT6iw/pwxbZUxSlSxpVUJJ7a59RZHZKxKMRaOt3ZbiNBW4MRuG5qIyYj8V/0LoZb2qULuxbpzZAUN4fZaEOOkGEt3XWbaSD92uLv9oDDiPsNCYe2GlQYTnSEBCuBviKRRfCCN/m+E6TRdQHt/SfZaD8MDon9Sb0LfbIJIuUHziJ5axKh9wXh81FF7Ixxz9jci9hNspikOfbQ4pNFjZZOyprQpiING1568QoRnxgJKBckkvnzLRa2q9qtdmREMaj+hLpYaSZ0trKGGpoZDY1E4/2B/NXbjdoDO1RZVdy5TQI/1y/pVfxjZaEVZIG7AMIdcoVE6vKJ6KmSp7m5MwFDeX2LdgWQtGYp6RicGkM7gRmpacyZd4prhMtxSlMpD8MxBtt18n2u7IRLTdc9GiYSMtejcLMpeF1YW/5xx2U4iwJCYknpUqTq/9hko3cao6f9pJ7sgKC1zLssgQz6YiqEK4TIG0O14xXbUEcpRF08c5k6q1ZyQqSiyNUBr19AIqTHiRuhvoSaZgyijNzhCuW3w6JDH2cF9ianqNjPSdTck6wiwlyXIBi0fZ6CtkaqQ9WqqByWPj8x62cja9lRe8tVsUPEDffmKM/hbWnC+ubV2pd8487re9tVjr9lwia3ui2xpZx/0pYusnlwxbxFLeFrNRz4JfMyova6mgOM2WXmWnpprCHwGTi4RxBjdXjf388vJUN/YyYMg675HAP/WL6H9BDkdu5RTWqZ+YuaZTWOds5HB0wTOzbG/RTg5bNjInOGerS0KyMrok8NdVkBM+fVumnEy3rRBv3h2j4HWWfcKhlyeJCSeIGlU20lgtRDxCMh1I7vPI7gbZFy3ZAL2WN41pI31CN6KM7TrCCuPWtOX8o3mXn6Xsp8iijymLZ8JRzrTcMFGU9n+aGGnKwbueyxlW7K9+f358EMMggPeX7A1aEOUGSu0nZS/Ze7xphs4ZNl4FOcne8jpPat3VVCN+ODu8/O4NfMjaUMO+bTApWo9oQnYxcuSo1+spkXN1JV7Kl6QfO7bzi5MYOEnfqh9YDWzTgdXgBJzknn+9+v465PjT29An93/98Wg/GL4+UOMkjZ+f/Ppk+Af4ZLjvlDF1xk+G4XL3ZZdsTvvKkHv7Dw==&lt;/diagram&gt;&lt;diagram id=&quot;acg6pv-CZbPK2pzaDbyy&quot; name=&quot;when TTL of session expires&quot;&gt;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&lt;/diagram&gt;&lt;diagram id=&quot;kdLMd2QgRlSv515nzq47&quot; name=&quot;choosing cnode for user&quot;&gt;7VpZb+M2EP41BpICDnTE12N8JGm77WbXzW7Rl4KWaIsNJaoU5aO/vkNStC46cVDH26LJQyQOr+Ec3zdU0vEn8faOozT6iYWYdjwn3Hb8acfz3KHrwUNKdoVkdO1qyYqTsJCVgjn5CxdCp5DmJMRZbaBgjAqS1oUBSxIciJoMcc429WFLRuu7pmiFW4J5gGhb+pWEItLSYc8p5feYrCKzs+sUPTEygwtBFqGQbSoif9bxJ5wxod/i7QRTaT1jFz3v9kDvXjGOE3HMhK/LL/Gnu9D5+Ot8DIYez3+I/W6xyhrRvDgwSQKaS5NrpcXOWGITEYHnKQpkewPu7vjjSMQUWi68LgmlE0YZh3bCEhg0pmiB6QPLiCAsAXEAmmLoH68xFwRs/KExQDC5KKJkZR1+U3QsmBAsho62Ccx5YAbeVkSFSe4wi7HgOxhS9PYHhXuKAO26Tk8LNqW7XePDqO7qIsyKEFvtFy+9AC+FI17hFO/dKXWnmGyruMQb2Vzin8Ald4PFAD0NP/PHEdltRzPcv/nDkicdr0+FNDGDY1Z90v8zZ6ajmylAu4EBYJKtso7ph7dV8VQLLYxgLjCAm8Q5iWsRYxmWrUj+nvwMEKtwjMtjSoAka5zAM8/ALcVScMRFc3mQaVUbu/KmhNGmhBIjIZnWhEsdUNJSHZ4oluGSLDIdNZQFSOCw2fGcpgurOReMh5h3Ax3NN8oZ/KLbrcovrQbOUBIu2PbAljW1tFm1qZVB/VsZGUupEXgDYsfhWORcGpyIyoqliSxGk9MTUEnN30RIxouxZEdCS8OKQaKdvCEQ7cAkLJMz0BoRSF4qe1LGRWY/kEOS/cokyQQRuUpkOQlcKw900BXtU4CwGg8N9IF0FnXAMTBB8VJYQCImYSgnjzmGzFCH8acOtFNGEqGStjfu9KZypVwwnT1q4Uxw9oQbWGaBtxOgz3WDETynDT/XfQv8jE6APjMR381+/Hy78z/cL+N48HXz28BCCK2YCReuPR4aLpMYYEzW8XzH6fcnE4unNOof4oQ92B9kkxZfVIKE5YKSBJxpSjan4UtQbKJ+Wo6Hnv5w6I596FlxFBJcHqeIACOeEg6ra7USyJdov5gp5DwpiVAqTRNvV7KCvUqw2DD+lF1lgnFVG54ipAZOI6ZG7SLDFlGDE0RUSO7S6WwZbj+694+fwl6AwugZPmvB8T8muAv3ErrvofbdcxoOngyuGjZRgCgpxamQhrPHbqcFzc/zmpVYWlyXP8N1SyyCqKIl/H7COxtea6a46QzU2+9g+MH0GLbBW5JJGNeQLTP4BTRucIpkICdksiysMVNLwUgxiE2hiW24ZJcD5ALusM7gTLBAMUV71vGHEvVDlaS5YiZ2WltfeJe2Xa9eorX8/05rtotO37FV1c4JUOjaG36fdmc958Msvh/cdHvXH73zopB3AIV0ar++5nob1IEk5gSvy4pfVW2yocpGJAROwrJ21EjYKPQuLBnNqMQli5qXx+dnRTcknduo9TlHO+NNqeGSQ4lQg0574Xnqel/XuRKOzbGPg+PXoPBJFS6Y5jzWsUeBgtnzKCCYAOQ0ifVw+CZzNo0KenzxgqrI70wxXBLqi2rpyggjVa0oHFOpXs+/lOM1YXmm9MSpKTpiVET98ShQ205Dt+Jo4MMgp1C3lXtiLst/WUV7Dlta8VRZpYVXinKc7ySWKVi5ojhZSWC+tUSPlf+PPExKnuEAtD3uEM/XGpXNWLrfa0m4YhhMcYwVtbGyzoQyIpV3l3VVK4OvNnS312uvgHYUhm9V5e5h9Y1S5ZgUKTyqz7cnKGXxPTVOatkjWxoXJoWb99Wvpdg9A0mY6v6skPgtUfnwLaRRd3wTVH6/cLz2wuFZrhuu7boxfKvrxvtntP/6ZzS3HlKD9ofZt/qK9st6GDxE+cMw+3I/H04fHkfj4Jj7a1lgvYfVvzWshv1zhRU0yz/4q77K/034s78B&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 456 82.5 C 456 76.7 469.43 72 486 72 C 502.57 72 516 76.7 516 82.5 L 516 96.5 C 516 102.3 502.57 107 486 107 C 469.43 107 456 102.3 456 96.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 456 65 C 456 59.2 469.43 54.5 486 54.5 C 502.57 54.5 516 59.2 516 65 L 516 79 C 516 84.8 502.57 89.5 486 89.5 C 469.43 89.5 456 84.8 456 79 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 456 47.5 C 456 41.7 469.43 37 486 37 C 502.57 37 516 41.7 516 47.5 L 516 61.5 C 516 67.3 502.57 72 486 72 C 469.43 72 456 67.3 456 61.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 456 82.5 C 456 88.3 469.43 93 486 93 C 502.57 93 516 88.3 516 82.5 M 456 65 C 456 70.8 469.43 75.5 486 75.5 C 502.57 75.5 516 70.8 516 65 M 456 47.5 C 456 53.3 469.43 58 486 58 C 502.57 58 516 53.3 516 47.5" fill="none" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 34px; margin-left: 486px;"><div data-drawio-colors="color: #0066CC; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 102, 204); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b>db0</b></div></div></div></foreignObject><text x="486" y="34" fill="#0066CC" font-family="Helvetica" font-size="12px" text-anchor="middle">db0</text></switch></g><path d="M 21 297.5 C 21 291.7 34.43 287 51 287 C 67.57 287 81 291.7 81 297.5 L 81 311.5 C 81 317.3 67.57 322 51 322 C 34.43 322 21 317.3 21 311.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 21 280 C 21 274.2 34.43 269.5 51 269.5 C 67.57 269.5 81 274.2 81 280 L 81 294 C 81 299.8 67.57 304.5 51 304.5 C 34.43 304.5 21 299.8 21 294 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 21 262.5 C 21 256.7 34.43 252 51 252 C 67.57 252 81 256.7 81 262.5 L 81 276.5 C 81 282.3 67.57 287 51 287 C 34.43 287 21 282.3 21 276.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 21 297.5 C 21 303.3 34.43 308 51 308 C 67.57 308 81 303.3 81 297.5 M 21 280 C 21 285.8 34.43 290.5 51 290.5 C 67.57 290.5 81 285.8 81 280 M 21 262.5 C 21 268.3 34.43 273 51 273 C 67.57 273 81 268.3 81 262.5" fill="none" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 249px; margin-left: 51px;"><div data-drawio-colors="color: #0066CC; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 102, 204); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b>db1</b></div></div></div></foreignObject><text x="51" y="249" fill="#0066CC" font-family="Helvetica" font-size="12px" text-anchor="middle">db1</text></switch></g><rect x="111" y="417" width="830" height="160" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 497px; margin-left: 113px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><div><b><font style="font-size: 20px;">Notes:</font></b></div><ol><li>when the key <b>sess:{user_id}-{hash}</b> expires or gets deleted, db0 sends a message <b>__keyevent@0__:&lt;expired | del&gt; </b><b style="border-color: var(--border-color);">sess:{user_id}-{hash}</b>;</li><li>the serverless function subscribes to <b style="border-color: var(--border-color);">__keyevent@0__:expired </b><span style="border-color: var(--border-color);">and</span><b style="border-color: var(--border-color);"> <b style="border-color: var(--border-color);">__keyevent@0__:del</b> </b><span style="border-color: var(--border-color);">events;</span></li><li><span style="border-color: var(--border-color);">when it receives a message, catches the <b>user_id</b> fragment from the key;</span></li><li><span style="border-color: var(--border-color);">after that, fetches the value of the key <b>user:{user_id} </b>in db1<b> </b></span>and remove it;</li><li><span style="border-color: var(--border-color);">knowing cNodePoolId, cNodeId, host and port of the sandbox, it makes two operations:</span></li><ol><li><span style="border-color: var(--border-color);">makes the request <b>DELETE http://{host}/sandboxes/{user_id}</b> to the cnode hosted in the {host} address;</span></li><li><span style="border-color: var(--border-color);">pushes the port as the last element of the array stored in the nested key <b>{cNodeId}</b> of <b>pool:{cNodePoolId}</b> in db1.</span></li></ol></ol></div></div></div></foreignObject><text x="113" y="501" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">Notes:...</text></switch></g><rect x="891" y="311.5" width="60" height="10.5" rx="1.4" ry="1.4" fill="#cccccc" stroke="#6881b3" stroke-width="1.33" pointer-events="all"/><rect x="891" y="299.25" width="60" height="10.5" rx="1.4" ry="1.4" fill="#cccccc" stroke="#6881b3" stroke-width="1.33" pointer-events="all"/><rect x="891" y="287" width="60" height="10.5" rx="1.4" ry="1.4" fill="#cccccc" stroke="#6881b3" stroke-width="1.33" pointer-events="all"/><rect x="891" y="274.75" width="60" height="10.5" rx="1.4" ry="1.4" fill="#cccccc" stroke="#6881b3" stroke-width="1.33" pointer-events="all"/><rect x="891" y="262.5" width="60" height="10.5" rx="1.4" ry="1.4" fill="#cccccc" stroke="#6881b3" stroke-width="1.33" pointer-events="all"/><path d="M 893.67 261.1 L 907.67 252 L 934.33 252 L 948.33 261.1 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.33" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="945.67" cy="316.75" rx="2.6666666666666665" ry="2.8" fill="#ffffff" stroke="none" pointer-events="all"/><ellipse cx="945.45" cy="304.5" rx="2.6666666666666665" ry="2.8" fill="#ffffff" stroke="none" pointer-events="all"/><ellipse cx="945.67" cy="292.25" rx="2.6666666666666665" ry="2.8" fill="#ffffff" stroke="none" pointer-events="all"/><ellipse cx="945.67" cy="280" rx="2.6666666666666665" ry="2.8" fill="#ffffff" stroke="none" pointer-events="all"/><ellipse cx="945.67" cy="267.75" rx="2.6666666666666665" ry="2.8" fill="#ffffff" stroke="none" pointer-events="all"/><path d="M 894.33 320.6 L 897.67 312.9 L 901 312.9 L 897.67 320.6 Z M 901 320.6 L 904.33 312.9 L 907.67 312.9 L 904.33 320.6 Z M 907.67 320.6 L 911 312.9 L 914.33 312.9 L 911 320.6 Z M 914.33 320.6 L 917.67 312.9 L 921 312.9 L 917.67 320.6 Z M 921 320.6 L 924.33 312.9 L 927.67 312.9 L 924.33 320.6 Z M 927.67 320.6 L 931 312.9 L 934.33 312.9 L 931 320.6 Z M 894.33 308.35 L 897.67 300.65 L 901 300.65 L 897.67 308.35 Z M 901 308.35 L 904.33 300.65 L 907.67 300.65 L 904.33 308.35 Z M 907.67 308.35 L 911 300.65 L 914.33 300.65 L 911 308.35 Z M 914.33 308.35 L 917.67 300.65 L 921 300.65 L 917.67 308.35 Z M 921 308.35 L 924.33 300.65 L 927.67 300.65 L 924.33 308.35 Z M 927.67 308.35 L 931 300.65 L 934.33 300.65 L 931 308.35 Z M 894.33 296.1 L 897.67 288.4 L 901 288.4 L 897.67 296.1 Z M 901 296.1 L 904.33 288.4 L 907.67 288.4 L 904.33 296.1 Z M 907.67 296.1 L 910.67 288.4 L 914 288.4 L 910.67 296.1 Z M 914.33 296.1 L 917.67 288.4 L 921 288.4 L 917.67 296.1 Z M 921 296.1 L 924.33 288.4 L 927.67 288.4 L 924.33 296.1 Z M 927.67 296.1 L 931 288.4 L 934.33 288.4 L 931 296.1 Z M 894.33 283.85 L 897.67 276.15 L 901 276.15 L 897.67 283.85 Z M 901 283.85 L 904.33 276.15 L 907.67 276.15 L 904.33 283.85 Z M 907.67 283.85 L 911 276.15 L 914.33 276.15 L 911 283.85 Z M 914.33 283.85 L 917.67 276.15 L 921 276.15 L 917.67 283.85 Z M 921 283.85 L 924.33 276.15 L 927.67 276.15 L 924.33 283.85 Z M 927.67 283.85 L 931 276.15 L 934.33 276.15 L 931 283.85 Z M 894.33 271.6 L 897.67 263.9 L 901 263.9 L 897.67 271.6 Z M 901 271.6 L 904.33 263.9 L 907.67 263.9 L 904.33 271.6 Z M 907.67 271.6 L 911 263.9 L 914.33 263.9 L 911 271.6 Z M 914.33 271.6 L 917.67 263.9 L 921 263.9 L 917.67 271.6 Z M 921 271.6 L 924.33 263.9 L 927.67 263.9 L 924.33 271.6 Z M 927.67 271.6 L 931 263.9 L 934.33 263.9 L 931 271.6 Z" fill="#ffffff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 329px; margin-left: 921px;"><div data-drawio-colors="color: #0066CC; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 102, 204); line-height: 1.2; pointer-events: all; white-space: nowrap;">CNode</div></div></div></foreignObject><text x="921" y="341" fill="#0066CC" font-family="Helvetica" font-size="12px" text-anchor="middle">CNode</text></switch></g><path d="M 486 257 L 486 237 L 486 113.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 486 108.12 L 489.5 115.12 L 486 113.37 L 482.5 115.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 170px; margin-left: 486px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">2. subscribed to <b>__keyevent@0:expired__ </b>&amp;<b> </b><b style="border-color: var(--border-color);">__keyevent@0:del__ </b>event</div></div></div></foreignObject><text x="486" y="173" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">2. subscribed to __keyevent@0:expired__ &amp; __keyevent@0:del__ event</text></switch></g><path d="M 486 317 L 486 367 L 51 367 L 51 328.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 51 323.12 L 54.5 330.12 L 51 328.37 L 47.5 330.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 366px; margin-left: 277px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">5.2. push the <b>{port}</b> as the last element of the array<br />stored in the key <b>pool:{cNodePoolId}.{cNodeId}</b></div></div></div></foreignObject><text x="277" y="370" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">5.2. push the {port} as the last element of the array...</text></switch></g><path d="M 551 287 L 884.63 287" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 889.88 287 L 882.88 290.5 L 884.63 287 L 882.88 283.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 284px; margin-left: 718px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">5.1. make the request<br /><b> DELETE http://{host}/sandboxes/{user_id}</b></div></div></div></foreignObject><text x="718" y="288" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">5.1. make the request...</text></switch></g><path d="M 421 287 L 171 287 L 87.37 287" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 82.12 287 L 89.12 283.5 L 87.37 287 L 89.12 290.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 289px; margin-left: 256px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">4. fetch the value of the key <b>user:{user_id} </b><br />and remove it</div></div></div></foreignObject><text x="256" y="293" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">4. fetch the value of the key user:{user_id}...</text></switch></g><rect x="421" y="257" width="130" height="60" rx="1" ry="1" fill="#000000" stroke="#000000" pointer-events="all" transform="translate(2,3)" opacity="0.25"/><rect x="421" y="257" width="130" height="60" rx="1" ry="1" fill="rgb(255, 255, 255)" stroke="#dddddd" pointer-events="all"/><image x="435.5" y="274.5" width="30" height="24" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnY9Imh0dHBzOi8vdmVjdGEuaW8vbmFubyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjE5Ljk4OTk5OTc3MTExODE2NCIgdmlld0JveD0iMCAwIDIwIDE5Ljk4OTk5OTc3MTExODE2NCI+JiN4YTsJPHN0eWxlIHR5cGU9InRleHQvY3NzIj4mI3hhOwkuc3Qwe2ZpbGw6IzQyODVmNDt9JiN4YTsJLnN0MXtmaWxsOiM2NjlkZjY7fSYjeGE7CS5zdDJ7ZmlsbDojYWVjYmZhO30mI3hhOwk8L3N0eWxlPiYjeGE7CTxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zIDMuOTlMMCA2LjQydjcuMTNsMyAyLjQ0eiIvPiYjeGE7CTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zIDMuOTlsLTMgNCAzLTJ6bS0zIDhsMyA0di0yeiIvPiYjeGE7CTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0wIDE1Ljk5bDQgNCAyLTItNi02em0uMDEtOEw1Ljk5IDJsLTItMkwwIDMuOTl6Ii8+JiN4YTsJPHBhdGggY2xhc3M9InN0MSIgZD0iTTE3IDE2bDMtMi40MlY2LjQ0TDE3IDR6Ii8+JiN4YTsJPHBhdGggY2xhc3M9InN0MCIgZD0iTTE3IDE2bDMtNC0zIDJ6bTMtOGwtMy00djJ6Ii8+JiN4YTsJPGcgY2xhc3M9InN0MiI+JiN4YTsJCTxwYXRoIGQ9Ik0yMCA0bC00LTQtMiAyIDYgNnptLS4wMSA4bC01Ljk4IDUuOTkgMiAyTDIwIDE2eiIvPiYjeGE7CQk8Y2lyY2xlIGN4PSI2IiBjeT0iOS45OSIgcj0iMSIvPiYjeGE7CQk8Y2lyY2xlIGN4PSIxMCIgY3k9IjkuOTkiIHI9IjEiLz4mI3hhOwkJPGNpcmNsZSBjeD0iMTMuOTkiIGN5PSI5Ljk5IiByPSIxIi8+JiN4YTsJPC9nPiYjeGE7PC9zdmc+" preserveAspectRatio="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 287px; margin-left: 488px;"><div data-drawio-colors="color: #999999; background-color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(153, 153, 153); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Cloud<br />Functions</div></div></div></foreignObject><text x="488" y="291" fill="#999999" font-family="Helvetica" font-size="12px">Cloud...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>