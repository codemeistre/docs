<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="961px" height="446px" viewBox="-0.5 -0.5 961 446" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2023-04-06T03:02:38.957Z&quot; agent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36&quot; etag=&quot;p5avqJ4lFgtFy3lA1IrN&quot; version=&quot;21.1.4&quot; type=&quot;google&quot; pages=&quot;3&quot;&gt;&lt;diagram name=&quot;redis-arrangement&quot; id=&quot;b47Vy8jbhvGGFrSf2t7A&quot;&gt;7VpZc9s2EP41mkkepOGhy48W7TjtxEdrT/uYAUlIRAwRCgld/vVdECAFkiAl1ZKaTGOPx+ACXO7x7fIDpI7rzTd3CVpE9yzEtONY4abj3nQcxx7bDvwTkq2UjMaWFMwSEqpFO8EzecNKmC9bkhCnpYWcMcrJoiwMWBzjgJdkKEnYurxsymj5qQs0wzXBc4BoXfo3CXkkpeOBtZN/xmQW5U+2LTUzR/liJUgjFLK1JnJvO66XMMblaL7xMBXBy+Mi7/vUMFsYluCYH3JDYnfD2+UXb2utH5/ut+Or/pXVVVpWiC6Vw3/ikKTCXM4SERtpO9/mAUnYMg6x0Gl13Mk6Ihw/L1AgZtcAAZBFfE7hyoYhRT6mTywlnLAYZAHYihOYWOGEE4jyl8oCzoQGRMnMuPxaTfiMczaHiSmh1GOUwaKbmMVgxWTOVsjPrBUWJDglb/o144hr14BXrF+D9/olZcFr4azCmDY9ZTFXmHXEinpO8gCDA3ijiVSO7jCbY55sYYmadfoKL6pg7KG6Xu/g5+RFFOnQyxciBflZoXuHChgoYBwBkn4NJB1nSOGxEx8GMzEIfSuXwSMKcQ09ImB5vjqOa1nDoecZEixx0ISSIv2N+KohSAMlW3JKYuwVHcOqAAkM87IfkKc8Ya9YmxmOx/bEhZlZgkKCd+4o+OXiG5KAdmlWzBKROqUs7yOOkERoIUIz38xE/+zFmK9Z8pr28vI7DabGZUw51qCGqaEBUqNzIWqwH1G5QCCmhKHh9yXLJ7ppVnzXsABCtJG3qflc0QPj4gVyreFT6iw/pwxbZUxSlSxpVUJJ7a59RZHZKxKMRaOt3ZbiNBW4MRuG5qIyYj8V/0LoZb2qULuxbpzZAUN4fZaEOOkGEt3XWbaSD92uLv9oDDiPsNCYe2GlQYTnSEBCuBviKRRfCCN/m+E6TRdQHt/SfZaD8MDon9Sb0LfbIJIuUHziJ5axKh9wXh81FF7Ixxz9jci9hNspikOfbQ4pNFjZZOyprQpiING1568QoRnxgJKBckkvnzLRa2q9qtdmREMaj+hLpYaSZ0trKGGpoZDY1E4/2B/NXbjdoDO1RZVdy5TQI/1y/pVfxjZaEVZIG7AMIdcoVE6vKJ6KmSp7m5MwFDeX2LdgWQtGYp6RicGkM7gRmpacyZd4prhMtxSlMpD8MxBtt18n2u7IRLTdc9GiYSMtejcLMpeF1YW/5xx2U4iwJCYknpUqTq/9hko3cao6f9pJ7sgKC1zLssgQz6YiqEK4TIG0O14xXbUEcpRF08c5k6q1ZyQqSiyNUBr19AIqTHiRuhvoSaZgyijNzhCuW3w6JDH2cF9ianqNjPSdTck6wiwlyXIBi0fZ6CtkaqQ9WqqByWPj8x62cja9lRe8tVsUPEDffmKM/hbWnC+ubV2pd8487re9tVjr9lwia3ui2xpZx/0pYusnlwxbxFLeFrNRz4JfMyova6mgOM2WXmWnpprCHwGTi4RxBjdXjf388vJUN/YyYMg675HAP/WL6H9BDkdu5RTWqZ+YuaZTWOds5HB0wTOzbG/RTg5bNjInOGerS0KyMrok8NdVkBM+fVumnEy3rRBv3h2j4HWWfcKhlyeJCSeIGlU20lgtRDxCMh1I7vPI7gbZFy3ZAL2WN41pI31CN6KM7TrCCuPWtOX8o3mXn6Xsp8iijymLZ8JRzrTcMFGU9n+aGGnKwbueyxlW7K9+f358EMMggPeX7A1aEOUGSu0nZS/Ze7xphs4ZNl4FOcne8jpPat3VVCN+ODu8/O4NfMjaUMO+bTApWo9oQnYxcuSo1+spkXN1JV7Kl6QfO7bzi5MYOEnfqh9YDWzTgdXgBJzknn+9+v465PjT29An93/98Wg/GL4+UOMkjZ+f/Ppk+Af4ZLjvlDF1xk+G4XL3ZZdsTvvKkHv7Dw==&lt;/diagram&gt;&lt;diagram id=&quot;acg6pv-CZbPK2pzaDbyy&quot; name=&quot;when TTL of session expires&quot;&gt;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&lt;/diagram&gt;&lt;diagram id=&quot;kdLMd2QgRlSv515nzq47&quot; name=&quot;choosing cnode for user&quot;&gt;7VpZU+s2FP41mYHOhHFssj1mA9rSXu5NuXT60lFsJVaRLVeWs/TX90iy4k2BMA257RQesHW0HZ3l+44MLW8SbW85SsKfWIBpy3WCbcubtly3M+i48JCSnZEMHC1ZcRLkskIwJ3/hXGiGZSTAaWWgYIwKklSFPotj7IuKDHHONtVhS0aruyZohRuCuY9oU/pEAhFq6aDrFPI7TFah2bnj5D0RMoNzQRqigG1KIm/W8iacMaHfou0EU2k9Yxc97+ZA714xjmNxzISn5dfo823gfPp1PgZDj+c/RF47X2WNaJYfmMQ+zaTJtdJiZyyxCYnA8wT5sr0Bd7e8cSgiCq0OvC4JpRNGGYd2zGIYNKZogekDS4kgLAaxD5pi6B+vMRcEbHxfGyCYXBRRsrIOH+UdCyYEi6CjaQJzHpiBtyVRbpJbzCIs+A6G5L29fu6ePEDbHaerBZvC3R3jw7Dq6jzM8hBb7RcvvAAvuSPe4BT3wylVp5hsK7nEHdpc4p3AJbf9RR89D77wxyHZbYcz3Bv9YcmTltujQpqYwTHLPun9mTHT0U4VoI1gAJhkq6xj+uFtlT/VQgsjmAsM4CZxTuJayFiKZSuUvyc/A8QqHOPymBIgyRrH8MxScEu+FBxxUV8eZFrV2q68LmG0LqHESEiqNeFSBxQ3VIcnimS4xItURw1lPhI4qHe8pOnCas4F4wHmbV9H80g5g1+022X5pdXAKYqDBdse2LKiljarNrUyqHcjI2MpNQJvQOw4HIuMS4MTUVqxMJHFaHJ6DCqp+ZsQyXgxlmxJaKlZ0Y+1kzcEoh2YhKVyBlojAslLZU/CuEjtB3JIvF+ZxKkgIlOJLCeBa+WBDrqieQoQluOhhj6QzqIKOAYmKF4KC0hEJAjk5DHHkBnqMN7UgXbCSCxU0nbHre5UrpQJprNHLZwKzp5xDcss8HYC9LmuMYLrNOHnumeBn+EJ0GcmotvZj19udt793TKK+k+b3/oWQmjETLDo2OOh5jKJAcZkLddznF5vMrF4SqP+IU7Yg/1BNmnwRSlIWCYoicGZpmRzar4ExSbqp+F46OkNBp2xBz0rjgKCi+PkEWDEU8Jhda1WDPkS7hczhZwrJSFKpGmi7UpWsFcxFhvGn9OrVDCuasNThFTfqcXUsFlk2CKqf4KICshtMp0tg+2nzt3j56DroyB8gc8acPyPCe6icwndd1D77jkN+88GVw2bKECUlOKUSMPZY7fTgOaXec1KLA2uy17guiUWfljSEn4/450NrzVTjFp99fY7GL4/PYZt8JakEsY1ZMsMfgWNa5wiGcgJmCwLK8zUUDBUDGJTaGIbLtnlALmAO6wzOBPMV0zRnHX8oUT1UAVprpiJncbWF+6lbder12gt+7/Tmu2i03NsVbVzAhS6dgffJ+1Z17mfRXf9Ubt7/ck9Lwq5B1BIp/bba673QR1IYk7wuqj4VdUmG6psRELgOChqR42EtULvwpLRjEpcsqh5eXx+lnRD0rm1Wp9ztDPelBouOZQIFei0F56nrvd1nSvh2Bz7ODh+CwqfVOGcac5jHXsUKJg9jwKCCUBOk1gPh28yZ9Mop8dXL6iK/M4UwwWhvqqWrowwUtWKwjGV6tX8SzheE5alSk+cmKIjQnnUH48Cle00dCuOBj70Mwp1W7En5rL8l1W067ClFU+VVRp4pSjH+U5imYKVK4rjlQTmG0v0WPn/yMMk5AUOQNvjDvFyrVHajCX7vZaEK4bBFEdYURsr6kwoIxJ5d1mXtTL4akN3e732BmhHQfBeVe4eVt8pVY5Jkdyj+nx7glIW31PjpJI9sqVxYZK7eV/9WordM5CEqe7PConfEpUP30Jqdcc3QeWPC8dbLxyu5brRsV03Bu913fj4jPZf/4zWqYZUv/lh9r2+ov2yHvgPYfYwSL/ezQfTh8fh2D/m/loUWB9h9W8Nq0HvXGEFzeIP/qqv9H8T3uxv&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="650" y="115" width="120" height="110" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 112px; margin-left: 651px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">includes</div></div></div></foreignObject><text x="710" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">includes</text></switch></g><rect x="650" y="270" width="290" height="130" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 288px; height: 1px; padding-top: 267px; margin-left: 651px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">includes</div></div></div></foreignObject><text x="795" y="267" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">includes</text></switch></g><rect x="20" y="20" width="460" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 65px; margin-left: 22px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><font style="font-size: 20px;"><b>Steps to choose the CNode for a given user</b></font><br /><ol><li>is there an<b> allocated </b><b style="border-color: var(--border-color);">sandbox</b> for the user? if so, return it</li><li>if not, what is the <b>cnode with most available ports</b> in the institution pool? </li></ol></div></div></div></foreignObject><text x="22" y="69" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">Steps to choose the CNode for a given user...</text></switch></g><path d="M 680 170.5 C 680 164.7 693.43 160 710 160 C 726.57 160 740 164.7 740 170.5 L 740 184.5 C 740 190.3 726.57 195 710 195 C 693.43 195 680 190.3 680 184.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 680 153 C 680 147.2 693.43 142.5 710 142.5 C 726.57 142.5 740 147.2 740 153 L 740 167 C 740 172.8 726.57 177.5 710 177.5 C 693.43 177.5 680 172.8 680 167 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 680 135.5 C 680 129.7 693.43 125 710 125 C 726.57 125 740 129.7 740 135.5 L 740 149.5 C 740 155.3 726.57 160 710 160 C 693.43 160 680 155.3 680 149.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 680 170.5 C 680 176.3 693.43 181 710 181 C 726.57 181 740 176.3 740 170.5 M 680 153 C 680 158.8 693.43 163.5 710 163.5 C 726.57 163.5 740 158.8 740 153 M 680 135.5 C 680 141.3 693.43 146 710 146 C 726.57 146 740 141.3 740 135.5" fill="none" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 202px; margin-left: 710px;"><div data-drawio-colors="color: #0066CC; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 102, 204); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b>db1</b></div></div></div></foreignObject><text x="710" y="214" fill="#0066CC" font-family="Helvetica" font-size="12px" text-anchor="middle">db1</text></switch></g><rect x="20" y="115" width="600" height="100" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 165px; margin-left: 22px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b><font style="font-size: 20px;">(1) How to check if there is an allocated sandbox for the user</font></b><br /><ul><li>fetch if the key <b>user:{user_id}</b> exists in db1;</li><li>if it does, return <b>host</b>, <b>port</b> and <b>protocol</b>;</li><li>it it does not, go to <b>(2)</b>.</li></ul></div></div></div></foreignObject><text x="22" y="169" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">(1) How to check if there is an allocated sandbox for the user...</text></switch></g><rect x="20" y="245" width="610" height="180" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 335px; margin-left: 22px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b><font style="font-size: 20px;">(2) How to check the cnode with most available ports</font></b><br /><ul><li>retrieve the pool that attends the user institution (<b>pool_id</b>);</li><li>retrieve all array values from the key <b style="border-color: var(--border-color);">pool:{pool_id}</b> in db1;</li><li style="border-color: var(--border-color);">fetch <b style="border-color: var(--border-color);">id</b>, <b style="border-color: var(--border-color);">totalAvailablePorts</b>, <b style="border-color: var(--border-color);">host </b>and <b style="border-color: var(--border-color);">protocol </b>for each cnode_id from the previous step in main db;</li><li>for each value, calculate the percentage of available ports: <b>100 * (array.length/totalAvailablePorts)</b></li><li>pick the cnode with max percentage of available ports.</li><li>pop the first element of the respective cnode array (<b>port</b>);</li><li>add the key <b>user:{user_id}</b> in db1<b style="border-color: var(--border-color);"> </b>with the values of pool_id, cnode_id, host, port and protocol</li><li style="border-color: var(--border-color);">return <b style="border-color: var(--border-color);">host</b>, <b style="border-color: var(--border-color);">port</b> and <b style="border-color: var(--border-color);">protocol</b>.</li></ul></div></div></div></foreignObject><text x="22" y="339" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">(2) How to check the cnode with most available ports...</text></switch></g><path d="M 690 335.5 C 690 329.7 703.43 325 720 325 C 736.57 325 750 329.7 750 335.5 L 750 349.5 C 750 355.3 736.57 360 720 360 C 703.43 360 690 355.3 690 349.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 690 318 C 690 312.2 703.43 307.5 720 307.5 C 736.57 307.5 750 312.2 750 318 L 750 332 C 750 337.8 736.57 342.5 720 342.5 C 703.43 342.5 690 337.8 690 332 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 690 300.5 C 690 294.7 703.43 290 720 290 C 736.57 290 750 294.7 750 300.5 L 750 314.5 C 750 320.3 736.57 325 720 325 C 703.43 325 690 320.3 690 314.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 690 335.5 C 690 341.3 703.43 346 720 346 C 736.57 346 750 341.3 750 335.5 M 690 318 C 690 323.8 703.43 328.5 720 328.5 C 736.57 328.5 750 323.8 750 318 M 690 300.5 C 690 306.3 703.43 311 720 311 C 736.57 311 750 306.3 750 300.5" fill="none" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 367px; margin-left: 720px;"><div data-drawio-colors="color: #0066CC; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 102, 204); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b>db1</b></div></div></div></foreignObject><text x="720" y="379" fill="#0066CC" font-family="Helvetica" font-size="12px" text-anchor="middle">db1</text></switch></g><path d="M 840 335.5 C 840 329.7 853.43 325 870 325 C 886.57 325 900 329.7 900 335.5 L 900 349.5 C 900 355.3 886.57 360 870 360 C 853.43 360 840 355.3 840 349.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 840 318 C 840 312.2 853.43 307.5 870 307.5 C 886.57 307.5 900 312.2 900 318 L 900 332 C 900 337.8 886.57 342.5 870 342.5 C 853.43 342.5 840 337.8 840 332 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 840 300.5 C 840 294.7 853.43 290 870 290 C 886.57 290 900 294.7 900 300.5 L 900 314.5 C 900 320.3 886.57 325 870 325 C 853.43 325 840 320.3 840 314.5 Z" fill="#cccccc" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><path d="M 840 335.5 C 840 341.3 853.43 346 870 346 C 886.57 346 900 341.3 900 335.5 M 840 318 C 840 323.8 853.43 328.5 870 328.5 C 886.57 328.5 900 323.8 900 318 M 840 300.5 C 840 306.3 853.43 311 870 311 C 886.57 311 900 306.3 900 300.5" fill="none" stroke="#6881b3" stroke-width="1.2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 367px; margin-left: 870px;"><div data-drawio-colors="color: #0066CC; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 102, 204); line-height: 1.2; pointer-events: all; white-space: nowrap;"><b>main db</b></div></div></div></foreignObject><text x="870" y="379" fill="#0066CC" font-family="Helvetica" font-size="12px" text-anchor="middle">main db</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>